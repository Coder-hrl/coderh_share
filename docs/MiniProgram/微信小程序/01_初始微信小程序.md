---
title: 微信小程序的基本使用
---

### 为什么各个平台都需要支持小程序

1. **你有,我也得有**,一旦出现一个新的产物,大的厂商都会依次跟进上
2. **小程序是介于 H5 和 App 的一项技术**
   - 体验比传统的 H5 页面要好很多
   - 相当于传统的 App,使用起来更加方便
3. **小程序间接动态的为 App 添加新功能**
   - 传统的 App 更新需要先打包,在上架到应用商店之后需要通过审核
   - 小程序可以在 App 不更新的情况下,动态为自己的应用添加新的功能需求
4. **微信小程序**在目前的所占市场率目前还是最高的

### 小程序的开发人员?

小程序是介于**原生 App 和 H5 页面**的一个产品

因为小程序的技术特点是`WXML,WXSS,JavaScript`;

它更接近于前端的开发技术栈,所以小程序都是`由前端来进行开发`

### 跨平台方案

> 都有较多的适配问题,所以需要了解原生的一些开发知识
>
> 适配产品**相较于原生 App 相差很多**
>
> **React-native flutter(比较看好)**

#### uni-app

由`DCloud团队`开发和维护,是由 Vue 进行开发,编写一套代码,可适配 IOS,Android,Web(H5)还有各个小程序

目前是很多公司的`技术选型`,特别是适配移动端 App 的公司

#### Taro

由`京东团队`开发和维护,是由 React 进行开发,是一个开放式`跨端 跨框架`解决方案

可以使用 Vue 和 React 进行开发

### 所使用的预备知识

- 页面布局:WXML, 类似于 HTML(View,Text)
- 页面样式,几乎是 CSS(某些不支持,某些进行了增强,但基本是一致的)
- 页面脚本:JavaScript+WXX(weixinScript)

因为里面的**核心思想基本上都是一致**的(组件化开发,数据响应式,mustache 语法,事件绑定等等)

### 需要 Appid 和开发工具

Appid 需要自己申请,开发工具可以在微信官网进行下载

### 在微信小程序中的 Storage 是可以存储对象类型

### VScode 开发,安装的三种插件

WXMLservice 小程序开发助手(提供代码提示) WeChat-snippet

### app.json 详解

`pages`属性,在页面上使用的 page 都需要在 pages 里面,注册才可以使用

`window`属性,存在 backgroudTextStyle

### 阅读官方文档

从指南开始看起,多看官方文档和指南

AppJs 中包含了一个`App()`函数,其中可以传入很多的 options 对象

Page 中包含了一个`Page()`函数,可以使用 const app = getApp()

### 启动顺序 ( 双线程加载,有加载 js 和 json 文件的,也有加载 wxml 和 wxss 的)

首先加载 App.json,之后执行 App.js,先执行 App 内容,然后会根据 App.json 中 pages 进行依次加载

### 微信小程序中遍历列表的方法

> 使用 wx:for 的方式来进行循环,wx:key 会默认获取到 item 值,会自动出现 item 和 index
>
> 与 Vue 中的`template`相似的是`block`方案,都不会渲染成元素

```jsx
<view wx:for="{{movies}}" wx:key="{{name}}">
  <view>
    {{item.name}}--{{item.age}}
  </view>
</view>
```

### setData

如果你需要修改 Data 中的值,同时也需要更新页面的话,需要使用 setData 方法来进行手动更新

### 小程序与普通网页开发

网页开发`渲染线程和脚本线程`是互斥的，这也是为什么长时间的脚本运行会导致页面失去响应，而在小程序中，这两个是分开的，同时微信客户端给小程序提供了宿主环境。

1. 这是因为网页开发者可以使用各种浏览器暴露出的 Dom，进行选中和操作

2. 但是在小程序中，Js-core 是`没有完整的全局对象`的，也就是指不会出现在`逻辑层操作Dom与渲染流程发生冲突`

View ==>Dom 监听==>到达 Model 触发方法

Model==>Databinding =>View 更新数据

| 代码构成 | 配置类型  |
| :------: | :-------: |
|  .json   | JSON 配置 |
|  .wxml   | WXML 配置 |
|  .wxss   | WXSS 配置 |
|   .js    |  JS 配置  |

### 工具配置 project.config.json

在使用一个工具时，都会针对各自喜好`做一些个性化配置`，例如界面颜色，编译配置，当换了电脑之后，`无须重新配置`

你在工具上做的任何配置，`都写入到这个文件中`，每当换电脑工作时，`开发者工具会自动帮你开发项目的个性配置`

### WXSS 样式

1. **增加了尺寸单位**，在编写 css 样式时开发者需要考虑手机屏幕不同的宽度和设备像素比，于是`新增了rpx尺寸单位`，这样小程序底层会来进行换算，不过因为`换算采用浮点数，会有一些偏差`.
2. **提供全局的样式和局部样式**，app.wxss 作为全局样式，page.wxss 作为单个页面的样式，注意`仅支持部分CSS选择器`

### 微信提供的接口

微信作为宿主环境，同时提供给微信小程序`众多暴露的接口`，包括`获取用户的地理位置`、`微信扫一扫能力`、`拍摄`、`录音`、`语音识别`、`二维码`、`地图`、`支付`、`分享`、`卡券`等几十个 API

### 小程序的发布流程

> 预览=>上传代码=>提交审核=>发布等步骤

#### 发布前最后的检查

1. 如果使用到了 Flex 布局，需要再上传小程序包时，打开上传代码时**样式自动补全**
2. 小程序服务器接口应该要走 HTTP 协议
3. 测试阶段不要在调试模式下进行测试，微信不会校验域名的合法性
4. 使用的网络接口在现网中部署，评估服务器的机器负载情况

#### 发布模式

小程序提供了两种发布模式，`全量发布`和`分阶段发布`

### 本地数据缓存

> wx.setStorageSync 和 wx.getStorageSync

1. 读写本地数据缓存
2. 我们可以用来缓存用户登录态 SessionId
3. 我们也可以利用本地提前渲染界面，带来较好的用户体验

### 双线程模型

> 小程序是基于双线程模型的，逻辑层与渲染层分开在不同的线程运行

我们需要像 Web 技术那样，有一份随时可更新的资源包放在云端，通过下载到本地，动态执行后即可渲染出界面。

既然小程序是基于双线程模型，那就意味着任何数据传递都是线程间的通信，也就是都会有一定的延时。这不像传统 Web 那样，当界面需要更新时，通过调用更新接口 UI 就会同步地渲染出来。在小程序架构里，这一切都会变成异步。

### 小程序的配置文件

可以保证开发出来的小程序样式不会差太多,同时为了统一规格样式

存在 `project.config.json` 和 `project.private.config.json`

private是私人基础库,仅仅是对于自己的本地环境,配置私有配置!

并不会同步到他人的公共环境中

#### sitemap

> 是否允许微信对小程序内容进行索引,添加到小程序的数据库中

sitemap配置,是否允许微信进行索引,微信会通过爬虫的形式,为小程序的页面内容建立索引.

|  属性  |   类型   | 必填 |        描述        |
| :----: | :------: | :--: | :----------------: |
| pages  | string[] |  是  |    页面路径列表    |
| window |  object  |  否  | 全局的默认窗口表现 |
| tabbar |  object  |  否  |   底部tab栏表现    |

#### tabbar

> 大部分都是由自己搭建而成

**list**:属性,可以添加tabbar属性,但是页面的初始显示由app.json中`pages`控制
